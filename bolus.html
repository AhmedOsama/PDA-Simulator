<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=480, initial-scale=1.0" />
    <title>Ø¯Ù„ÙŠÙ„ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø®</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="style/app.css" />
    <link rel="preload" href="assets/FinalCover.png" as="image">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="style/keyboard.css" />
    <style>
      .screen.active {
        display: flex;
      }

      .header {
        text-align: center;
        padding: 20px 20px 30px;
      }

      .header h1 {
        font-size: 24px;
        font-weight: normal;
        color: #333;
        margin: 0;
      }

      .content {
        flex-grow: 1;
        padding: 0 20px;
      }

      .blood-sugar-controls {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 40px;
        margin: 30px 0;
      }
      .meal {
        display: block;
        font-size: 20px;
        color: #333;
        margin-top: 5px;
        text-align: center;
      }
      .meal.val {
        font-size: 16px;
        color: #666;
        margin-top: 5px;
      }
      .blood-sugar-button {
        width: 60px;
        height: 60px;
        background-color: #1b52a4;
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 40px;
        line-height: 1;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
      }

      .blood-sugar-value {
        color: #4ade80;
        font-size: 50px;
        font-weight: 500;
        position: relative;
        margin: 0 30px;
      }

      .blood-sugar-value::after {
        content: "";
        position: absolute;
        top: 80px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-top: 10px solid #4ade80;
      }

      .ruler-container {
        position: relative;
        width: 100%;
        height: 100px;
        overflow: hidden;
        margin: 20px 0;
      }

      .ruler {
        position: absolute;
        top: 20px;
        width: 100%;
        height: 90px;
        overflow: hidden;
      }

      .ruler-track {
        display: flex;
        position: absolute;
        top: 0;
        height: 4px;
        align-items: flex-start;
      }

      .ruler-ticks {
        display: flex;
        position: absolute;
        top: 4px;
        height: 40px;
      }

      .ruler-pointer {
        position: absolute;
        top: 20px;
        width: 4px;
        height: 40px;
        background-color: #4ade80;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        border-radius: 5px;
      }

      .question-screen {
        text-align: center;
        padding: 40px 20px;
      }

      .question-title {
        font-size: 22px;
        font-weight: 600;
        margin-bottom: 40px;
        color: #333;
        line-height: 1.4;
      }

      .food-icon {
        width: 120px;
        height: 120px;
        margin: 0 auto 40px;
        background: #4ade80;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 60px;
        color: white;
      }

      .question-buttons {
        display: flex;
        gap: 36px;
        justify-content: center;
        align-items: baseline;
        margin-top: 200px;
        margin-inline: 50px;
      }

      .question-button {
        flex: 1;
        padding: 16px 20px;
        border: none;
        border-radius: 12px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        background: #1b52a4;
        color: white;
      }

      .carb-input-screen {
        text-align: center;
        padding: 40px 20px;
      }

      .carb-input-title {
        font-size: 22px;
        font-weight: 600;
        margin-bottom: 40px;
        color: #333;
        line-height: 1.4;
      }

      .carb-input-field {
        border: 2px solid #1b52a4;
        border-radius: 12px;
        padding: 15px 20px;
        font-size: 24px;
        text-align: center;
        background: white;
        width: 200px;
        display: block;
      }

      .carb-unit {
        font-size: 18px;
        color: #666;
        margin-right: 10px;
      }

      .summary-screen {
        padding: 20px;
      }

      .summary-title {
        font-size: 22px;
        font-weight: 600;
        color: #333;
        text-align: center;
      }

      .summary-dose {
        text-align: center;
      }

      .summary-dose-number {
        font-size: 48px;
        color: #1b52a4;
        margin-bottom: 10px;
      }

      .summary-dose-unit {
        font-size: 20px;
        color: #1b52a4;
      }

      .summary-details {
        background: white;
        border-radius: 12px;
        padding: 20px;
      }

      .summary-detail-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .summary-detail-item:first-child {
        border-top: 1px solid #f0f0f0;
      }

      .summary-detail-label {
        font-size: 24px;
        color: #333;
      }

      .summary-detail-value {
        font-size: 24px;
        color: #666;
      }

      .summary-button {
        background: #1b52a4;
        color: white;
        border: none;
        border-radius: 12px;
        padding: 16px;
        font-size: 18px;
        font-weight: 600;
        width: 80%;
        cursor: pointer;
        margin: 20px auto;
        display: block;
        margin-top: 58px;
      }

      .insulin-input-screen {
        padding: 20px;
      }

      .insulin-input-title {
        font-size: 22px;
        font-weight: 600;
        color: #333;
        text-align: center;
        margin-bottom: 40px;
        line-height: 1.4;
      }

      .insulin-input-sections {
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
      }

      .insulin-input-section {
        text-align: center;
        flex: 1;
      }

      .insulin-input-label {
        font-size: 16px;
        color: #333;
        margin-bottom: 15px;
      }

      .insulin-input-field {
        border: 2px solid #e5e5e5;
        border-radius: 12px;
        padding: 15px;
        font-size: 20px;
        text-align: center;
        background: white;
        width: 80px;
        margin: 0 auto;
      }

      .insulin-input-field:focus {
        border-color: #1b52a4;
        outline: none;
      }

      .insulin-total {
        text-align: center;
        margin: 30px 0;
        font-size: 18px;
        color: #333;
      }

      .insulin-duration {
        text-align: center;
        margin: 30px 0;
      }

      .insulin-duration-label {
        font-size: 16px;
        color: #333;
        margin-bottom: 15px;
      }

      .insulin-duration-field {
        border: 2px solid #e5e5e5;
        border-radius: 12px;
        padding: 15px 20px;
        font-size: 20px;
        text-align: center;
        background: white;
        width: 100px;
        margin: 0 auto;
      }

      .insulin-duration-unit {
        font-size: 16px;
        color: #666;
        margin-right: 10px;
      }
      .screen {
        background-color: #fff;
      }
      .main-footer {
        padding: 20px;
        background-color: #fff;
      }

      .nav-button {
        background: none;
        border: none;
        color: #1b52a4;
        font-size: 17px;
        cursor: pointer;
        padding: 0;
        font-weight: 400;
      }

      .nav-button:disabled {
        color: #c7c7cc;
        cursor: not-allowed;
      }
      .note {
        font-size: 14px;
        color: #666;
        text-align: center;
        margin-top: 20px;
        line-height: 1.5;
        display: flex;
        align-items: flex-start;
        gap: 8px;
        justify-content: center;
      }

      .note i {
        display: inline-block;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: 1px solid #737373;
        color: #737373;
        font-style: normal;
        text-align: center;
        line-height: 18px;
        font-size: 12px;
        flex-shrink: 0;
      }

      .food-categories {
        display: flex;
        justify-content: space-around;
        margin: 30px 0;
        padding: 0 10px;
      }

      .food-category {
        text-align: center;
        opacity: 0.4;
      }

      .food-category span {
        display: block;
        font-size: 12px;
        color: #333;
        margin-top: 5px;
      }

      .food-category-icon {
        width: 40px;
        height: 40px;
        margin: 0 auto 5px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
      }

      .bottom-tabs {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        display: flex;
        height: 60px;
        background: white;
        border-top: 1px solid #e5e5e5;
      }

      .bottom-tab {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: #999;
        font-size: 10px;
        cursor: pointer;
      }

      .bottom-tab.active {
        color: #1b52a4;
      }

      .bottom-tab i {
        font-size: 16px;
        margin-bottom: 4px;
      }

      .extended-dose-tabs {
        display: flex;
        background: white;
        border-radius: 12px;
        padding: 4px;
        margin-bottom: 30px;
      }

      .extended-dose-tab {
        flex: 1;
        padding: 12px;
        text-align: center;
        background: transparent;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        color: #666;
      }

      .extended-dose-tab.active {
        background: #f0f0f0;
        color: #333;
      }
      .header {
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <div class="phone-container">
      <!-- Status Bar -->
      <header>  <div class="white-overlay">
        <div class="icon-block block1"></div>
        <div class="icon-block block2"></div>
        <div class="icon-block block3"></div>
        <div class="icon-block block4"></div>
      </div></header>

      <!-- Screen 1: Blood Sugar Input -->
      <div id="screen1" class="screen active">
        <div class="header">
          <h1>Ø¯Ù„ÙŠÙ„ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø®</h1>
        </div>
        <div class="content">
          <div class="blood-sugar-screen p-0">
            <section
              class="d-flex flex-column align-items-center mt-4"
              style="font-family: sans-serif; direction: ltr"
            >
              <div
                class="d-flex flex-column align-items-center w-100"
                style="font-family: 'Roboto', sans-serif"
              >
                <div class="d-flex align-items-center gap-3 mb-1">
                  <button
                    id="decrement"
                    class="btn"
                    style="
                      width: 60px;
                      height: 60px;
                      background-color: #2e61ae;
                      color: white;
                      border-radius: 10px;
                      font-size: 40px;
                      line-height: 1;
                      padding: 0;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <i class="fa fa-minus"></i>
                  </button>
                  <div
                    id="glucoseValue"
                    style="
                      color: #33cc7a;
                      font-size: 50px;
                      font-weight: 500;
                      position: relative;
                      margin-inline: 30px;
                    "
                  >
                    90
                    <div
                      style="
                        position: absolute;
                        top: 73px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 0;
                        height: 0;
                        border-left: 9px solid transparent;
                        border-right: 9px solid transparent;
                        border-top: 16px solid #33cc7a;
                      "
                    ></div>
                  </div>
                  <button
                    id="increment"
                    class="btn"
                    style="
                      width: 60px;
                      height: 60px;
                      background-color: #2e61ae;
                      color: white;
                      border-radius: 10px;
                      font-size: 40px;
                      line-height: 1;
                      padding: 0;
                      display: flex;
                      justify-content: center;
                      align-items: center;
                    "
                  >
                    <i class="fa fa-plus"></i>
                  </button>
                </div>

                <div
                  class="position-relative w-100"
                  style="height: 100px; overflow: hidden"
                >
                  <div
                    id="ruler-container"
                    class="position-absolute start-0"
                    style="
                      top: 20px;
                      width: 100%;
                      height: 90px;
                      overflow: hidden;
                    "
                  >
                    <div
                      id="ruler"
                      class="d-flex position-absolute"
                      style="top: 0; height: 4px; align-items: flex-start"
                    ></div>
                    <div
                      id="ticks"
                      class="d-flex position-absolute"
                      style="top: 4px; height: 40px"
                    ></div>
                  </div>
                  <div
                    id="pointer"
                    style="
                      position: absolute;
                      top: 20px;
                      width: 4px;
                      height: 40px;
                      background-color: #33cc7a;
                      left: 50%;
                      transform: translateX(-50%);
                      z-index: 10;
                      border-radius: 5px;
                    "
                  ></div>
                </div>
              </div>
            </section>
            <script>
              let minValue = 20;
              let maxValue = 600;
              let step = 1;
              let unitsVisible = 40;
              let unitWidth = 14;

              let currentValue = 90;
              let glucoseValue = document.getElementById("glucoseValue");
              let ruler = document.getElementById("ruler");
              let ticksContainer = document.getElementById("ticks");

              function updateGlucoseText() {
                glucoseValue.innerHTML = `${currentValue} <div style="position: absolute; top: 73px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 9px solid transparent; border-right: 9px solid transparent; border-top: 16px solid #33cc7a;"></div>`;

                if (document.querySelector(".glucose-value")) {
                  document.querySelector(
                    ".glucose-value"
                  ).innerHTML = `${currentValue}mg/dl`;
                }
              }

              function generateRuler() {
                ruler.innerHTML = "";
                ticksContainer.innerHTML = "";

                for (let i = minValue; i <= maxValue; i++) {
                  const tick = document.createElement("div");
                  tick.style.position = "relative";
                  tick.style.flex = `0 0 ${unitWidth}px`;
                  tick.style.maxWidth = `${unitWidth}px`;
                  tick.style.textAlign = "center";

                  const line = document.createElement("div");
                  line.style.height = i % 10 === 0 ? "26px" : "12px";
                  line.style.background = i % 10 === 0 ? "black" : "gray";
                  line.style.margin = "2px auto";
                  line.style.width = "2px";
                  tick.appendChild(line);

                  if (i % 10 === 0) {
                    const label = document.createElement("div");
                    label.innerText = i;
                    label.style.fontSize = "20px";
                    label.style.fontWeight = "bold";
                    label.style.marginTop = "10px";
                    tick.appendChild(label);
                  }

                  ticksContainer.appendChild(tick);

                  const rulerSegment = document.createElement("div");
                  rulerSegment.style.flex = `0 0 ${unitWidth}px`;
                  rulerSegment.style.height = "6px";

                  if (i == 79) {
                    rulerSegment.style.flex = `0 0 8px`;
                  }
                  if (i == 80) {
                    rulerSegment.style.flex = `0 0 20px`;
                  }
                  if (i <= 79) {
                    rulerSegment.style.backgroundColor = "#ee5e56";
                  } else if (i <= 140) {
                    rulerSegment.style.backgroundColor = "#33cc7a";
                  } else {
                    rulerSegment.style.backgroundColor = "#ee5e56";
                  }

                  ruler.appendChild(rulerSegment);
                }
              }
              function updateRulerPosition() {
                const centerIndex = currentValue - minValue;
                const containerWidth =
                  ruler.parentElement.offsetWidth ||
                  document.querySelector(".phone-container").clientWidth; // assumes ruler is inside a fixed-size container
                const centerOffset = containerWidth / 2;
                const newLeft = -(centerIndex * unitWidth - centerOffset) - 7.5;
                console.log(
                  `centerIndex: ${centerIndex}, containerWidth: ${containerWidth}, centerOffset: ${centerOffset}, newLeft: ${newLeft}`
                );

                ruler.style.left = `${newLeft}px`;
                ticksContainer.style.left = `${newLeft}px`;
              }
              function updateView() {
                updateGlucoseText();
                updateRulerPosition();
              }

              document.getElementById("increment").onclick = () => {
                if (currentValue + step <= maxValue) {
                  currentValue += step;
                  updateView();
                }
              };

              document.getElementById("decrement").onclick = () => {
                if (currentValue - step >= minValue) {
                  currentValue -= step;
                  updateView();
                }
              };

              generateRuler();
              updateView();
            </script>
          </div>
          <div
            style="
              text-align: center;
              margin-top: 15px;
              color: #666;
              font-size: 16px;
            "
          >
            mg/dl
          </div>

          <div
            style="
              text-align: center;
              margin-top: 20px;
              color: #666;
              font-size: 18px;
            "
          >
            Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¬Ù„ÙˆÙƒÙˆØ² Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‡ÙŠ
            <span style="color: #1b52a4" class="glucose-value">88mg/dl</span> Ù‡Ù„
            ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…<br />
            Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ…Ø© ÙÙŠ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø®ØŸ
          </div>
        </div>
        <div class="main-footer">
          <button
            class="btn-primary m-auto d-block text-center"
            style="width: 80%"
            onclick="showScreen('screen2')"
          >
            Ø³ÙØ¬ÙÙ„Ù‘
          </button>
        </div>
        <div class="footer">
          <button class="nav-button" onclick="handlePdaModeNavigation()">Ø¥Ù„ØºØ§Ø¡</button>
          <div class="progress-dots">
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
          </div>
          <button class="nav-button" onclick="handlePdaModeNavigation(); localStorage.setItem('openMenuOnLoad', 'true');">Ø®Ø±ÙˆØ¬</button>
        </div>
      </div>

      <!-- Screen 2: Food Question -->
      <div id="screen2" class="screen">
        <div class="header">
          <h1>Ø¯Ù„ÙŠÙ„ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø®</h1>
        </div>
        <div class="content question-screen pt-0">
          <h2 class="question-title">Ù‡Ù„ Ø³ØªØ£ÙƒÙ„ Ø§Ù„Ø¢Ù†ØŸ</h2>
          <div class="food-icon bg-transparent">
            <img src="assets/pump/bowl.png" alt="" srcset="" />
          </div>
          <div class="question-buttons">
            <button class="question-button" onclick="showScreen('screen5')">
              Ù„Ø§
            </button>
            <button class="question-button" onclick="showScreen('screen3')">
              Ù†Ø¹Ù…
            </button>
          </div>
        </div>
        <div class="footer">
          <button class="nav-button" onclick="handlePdaModeNavigation(); localStorage.setItem('openMenuOnLoad', 'true');">Ø®Ø±ÙˆØ¬</button>
          <div class="progress-dots">
            <div class="progress-dot"></div>
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
          </div>
          <button class="nav-button" onclick="showScreen('screen1')">
            Ø§Ù„Ø³Ø§Ø¨Ù‚
          </button>
        </div>
      </div>

      <!-- Screen 3: Carb Input -->
      <div id="screen3" class="screen">
        <div class="header">
          <h1>Ø¯Ù„ÙŠÙ„ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø®</h1>
        </div>
        <div class="content carb-input-screen">
          <h2 class="carb-input-title">
            Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ© Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª<br />Ø§Ù„Ù…ØªÙ†Ø§ÙˆÙ„Ø©
          </h2>

          <div
            style="
              display: flex;
              align-items: center;
              justify-content: center;
              gap: 10px;
              margin: 40px 0;
              direction: ltr;
            "
          >
            <span class="carb-unit">Ø¬Ù…</span>
            <input
              type="number"
              class="carb-input-field virtual-keyboard-input"
              placeholder="200~0"
              id="carbInput"
            />
          </div>

          <!-- <div class="food-categories">
            <div class="food-category">
              <div class="food-category-icon" style="background: #ff6b6b">
                ğŸ
              </div>
              <span>Ø¥ÙØ·Ø§Ø±</span>
              <span>0.0ÙˆØ­Ø¯Ø©</span>
            </div>
            <div class="food-category">
              <div class="food-category-icon" style="background: #4ecdc4">
                ğŸ¥—
              </div>
              <span>ØºØ¯Ø§Ø¡</span>
              <span>0.0ÙˆØ­Ø¯Ø©</span>
            </div>
            <div class="food-category">
              <div class="food-category-icon" style="background: #ffe66d">
                ğŸ½ï¸
              </div>
              <span>Ø¹Ø´Ø§Ø¡</span>
              <span>0.0ÙˆØ­Ø¯Ø©</span>
            </div>
            <div class="food-category">
              <div class="food-category-icon" style="background: #a8e6cf">
                ğŸ
              </div>
              <span>ÙˆØ¬Ø¨Ø© Ø®ÙÙŠÙØ©</span>
              <span>0.0ÙˆØ­Ø¯Ø©</span>
            </div>
          </div> -->
        </div>
        <div class="main-footer">
          <button class="btn-primary" onclick="showScreen('screen4')">
            Ù†Ø¹Ù…
          </button>
        </div>
        <div class="footer">
          <button class="nav-button" onclick="showScreen('screen2')">
            Ø§Ù„Ø³Ø§Ø¨Ù‚
          </button>
          <div class="progress-dots">
            <div class="progress-dot"></div>
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
          </div>
          <button class="nav-button" onclick="handlePdaModeNavigation(); localStorage.setItem('openMenuOnLoad', 'true');">Ø®Ø±ÙˆØ¬</button>
        </div>
      </div>

      <!-- Screen 4: Summary -->
      <div id="screen4" class="screen">
        <div class="header pb-0">
          <h1>Ø¯Ù„ÙŠÙ„ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø®</h1>
        </div>
        <div class="content summary-screen">
          <h2 class="summary-title">Ø¬Ø±Ø¹Ø© Ø§Ù„Ø¶Ø® Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡Ø§</h2>

          <div class="summary-dose">
            <div
              class="align-items-baseline d-flex justify-content-center w-100 gap-2"
            >
              <div class="summary-dose-unit">ÙˆØ­Ø¯Ø©</div>
              <div class="summary-dose-number">99.975</div>
              <div class="summary-dose-unit opacity-0">ÙˆØ­Ø¯Ø©</div>
            </div>
            <div
              style="
                margin-top: -10px;
                margin-right: 24px;
                color: #1b52a4;
                text-align: right;
                font-size: 18px;
                display: block;
              "
            >
              ØªÙØ§ØµÙŠÙ„
            </div>
          </div>

          <div class="summary-details">
            <div class="summary-detail-item">
              <span class="summary-detail-label">Ø³ÙƒØ± Ø§Ù„Ø¯Ù…</span>
              <span class="summary-detail-value">88.0mg/dl</span>
            </div>
            <div class="summary-detail-item">
              <span class="summary-detail-label">Ø§Ù„ÙƒØ±Ø¨ÙˆÙ‡ÙŠØ¯Ø±Ø§Øª</span>
              <span class="summary-detail-value">100Ø¬Ù…</span>
            </div>
            <div class="summary-detail-item">
              <span class="summary-detail-label">Ø§Ù„Ø£Ù†Ø³ÙˆÙ„ÙŠÙ† Ø§Ù„Ù†Ø´Ø·</span>
              <span class="summary-detail-value">0.269ÙˆØ­Ø¯Ø©</span>
            </div>
          </div>

          <button class="summary-button" onclick="showScreen('screen6')">
            Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø¶Ø®Ø©
          </button>

          <div class="note">
            <span>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¶Ø® Ù‡ÙŠ Ù…Ø±Ø¬Ø¹ÙŠØ© ÙÙ‚Ø·. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø£Ù…Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨.</span>
            <i>i</i>
          </div>
        </div>
        <div class="footer">
          <button class="nav-button" onclick="handlePdaModeNavigation(); localStorage.setItem('openMenuOnLoad', 'true');">Ø®Ø±ÙˆØ¬</button>
          <div class="progress-dots">
            <div class="progress-dot "></div>
            <div class="progress-dot"></div>
            <div class="progress-dot active"></div>
          </div>
          <button class="nav-button" onclick="showScreen('screen3')">
            Ø§Ù„Ø³Ø§Ø¨Ù‚
          </button>
        </div>
      </div>

      <!-- Screen 5: Insulin Input -->
      <div id="screen5" class="screen">
        <div
          class="header text-center position-relative d-flex justify-content-center align-items-center pb-2 pt-0 mt-0"
          style="font-size: 24px"
        >
          <div>Ø¶Ø®Ø© Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†</div>
          <div
            class="position-absolute"
            onclick="showScreen('screen6')"
            style="right: 20px"
          >
            <i class="fa fa-chevron-left"></i>
            Ø±Ø¬ÙˆØ¹
          </div>
        </div>
        <div
          class="content insulin-input-screen"
          style="padding: 20px 0; background: #f5f5f5; position: relative"
        >
          <div
            style="
              background: #fff;
              position: absolute;
              width: 100%;
              padding: 20px;
              top: 12px;
            "
          >
            <!-- Input Sections -->
            <div style="display: flex; justify-content: space-between">
              <div style="flex: 1">
                <div style="font-size: 24px; color: #333; margin-bottom: 20px">
                  Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¢Ù†
                </div>
                <div class="d-flex align-items-center gap-2">
                  <input
                    type="text"
                    class="virtual-keyboard-input"
                    value="0.3"
                    id="currentAmount"
                    style="
                      border: 2px solid #e5e5e5;
                      border-radius: 12px;
                      padding: 15px;
                      font-size: 24px;
                      text-align: center;
                      background: #f5f5f5;
                      width: 100px;

                      display: block;
                    "
                  />
                  <div style="margin-top: 8px; font-size: 20px; color: #333">
                    ÙˆØ­Ø¯Ø©
                  </div>
                </div>
              </div>
              <div style="flex: 1">
                <div style="font-size: 24px; color: #333; margin-bottom: 20px">
                  Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ù…ØªØ¯Ø©
                </div>
                <div class="d-flex align-items-center gap-2">
                  <input
                    type="text"
                    class="virtual-keyboard-input"
                    value="0"
                    id="extendedAmount"
                    style="
                      border: 2px solid #e5e5e5;
                      border-radius: 12px;
                      padding: 15px;
                      font-size: 24px;
                      text-align: center;
                      background: #f5f5f5;
                      width: 100px;

                      display: block;
                    "
                  />
                  <div style="margin-top: 8px; font-size: 20px; color: #333">
                    ÙˆØ­Ø¯Ø©
                  </div>
                </div>
              </div>
            </div>

            <!-- Total -->
            <div style="margin: 20px 0; font-size: 18px; color: #666">
              Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¶Ø®0.3ÙˆØ­Ø¯Ø©
            </div>

            <!-- Duration -->
            <div style="margin-bottom: 60px">
              <div style="font-size: 24px; color: #333; margin-bottom: 15px">
                ÙØªØ±Ø© Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„Ù…Ù…ØªØ¯Ø©
              </div>
              <div style="display: flex; align-items: center; gap: 15px">
                <input
                  type="text"
                  class="virtual-keyboard-input"
                  value="0.5"
                  id="durationInput"
                  style="
                    border: 2px solid #e5e5e5;
                    border-radius: 12px;
                    padding: 15px 20px;
                    font-size: 24px;
                    text-align: center;
                    background: #f5f5f5;
                    width: 120px;
                  "
                />
                <span style="font-size: 20px; color: #333">Ø³Ø§Ø¹Ø©</span>
              </div>
            </div>
          </div>
        </div>
        <div class="footer bg-white border-0 p-4">
          <button class="nav-button" style="color: #1b52a4">Ø¥Ù„ØºØ§Ø¡</button>
          <button class="nav-button" style="color: #1b52a4">Ù†Ø¹Ù…</button>
        </div>
      </div>

      <!-- Screen 6: Extended Dose -->
      <div id="screen6" class="screen">
        <div
          class="header text-center position-relative d-flex justify-content-center align-items-center pb-2 pt-0 mt-0"
          style="font-size: 24px"
        >
          <div>Ø¶Ø®Ø© Ø£Ù†Ø³ÙˆÙ„ÙŠÙ†</div>
          <div
            class="position-absolute"
            onclick="showScreen('screen4')"
            style="right: 20px"
          >
            <i class="fa fa-chevron-left"></i>
            Ø±Ø¬ÙˆØ¹
          </div>
        </div>
        <div class="content" style="padding: 20px">
          <!-- Food Categories -->
          <div
            style="
              display: flex;
              justify-content: space-between;
              padding: 20px;
              background: #f5f5f5;
              margin-inline: -20px;
            "
          >
            <div>
              <span class="meal">Ø¥ÙØ·Ø§Ø±</span>
              <span class="meal val">0.0ÙˆØ­Ø¯Ø©</span>
            </div>
            <div>
              <span class="meal">ØºØ¯Ø§Ø¡</span>
              <span class="meal val">0.0ÙˆØ­Ø¯Ø©</span>
            </div>
            <div>
              <span class="meal">Ø¹Ø´Ø§Ø¡</span>
              <span class="meal val">0.0ÙˆØ­Ø¯Ø©</span>
            </div>
            <div>
              <span class="meal">ÙˆØ¬Ø¨Ø© Ø®ÙÙŠÙØ©</span>
              <span class="meal val">0.0ÙˆØ­Ø¯Ø©</span>
            </div>
          </div>

          <!-- Insulin Input -->
          <div style="text-align: center; margin: 80px 0">
            <div
              style="
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 15px;
              "
            >
              <span style="font-size: 24px; color: #333">ÙˆØ­Ø¯Ø©</span>
              <input
                type="text"
                class="virtual-keyboard-input"
                value="0.3"
                id="insulinDose"
                style="
                  border: 2px solid #e5e5e5;
                  border-radius: 12px;
                  padding: 15px 20px;
                  font-size: 24px;
                  text-align: center;
                  background: #f5f5f5;
                  width: 120px;
                "
              />
              <span style="font-size: 24px; color: #333"> Ø¶Ø®Ø© Ø£Ù†Ø³ÙˆÙ„ÙŠÙ† </span>
            </div>
          </div>

          <!-- Start Button -->
          <div
            style="
              padding-block: 30px 130px;
              background-color: #f5f5f5;
              padding-inline: 50px;
              margin-inline: -20px;
            "
          >
            <button
              style="
                background: #1b52a4;
                color: white;
                border: none;
                border-radius: 12px;
                padding: 16px;
                font-size: 18px;
                font-weight: 600;
                width: 100%;
                cursor: pointer;
              "
              onclick="showScreen('screen5')"
            >
              Ø§Ø¨Ø¯Ø£
            </button>
          </div>
        </div>

        <!-- Bottom Tabs -->
        <div
          style="
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            background: white;
          "
        >
          <div
            style="
              flex: 1;
              text-align: center;
              padding: 20px 12px;
              color: #1b52a4;
              font-size: 20px;
            "
          >
            Ø¬Ø±Ø¹Ø© Ù…Ø²Ø¯ÙˆØ¬Ø© Ù…Ù…ØªØ¯Ø©
          </div>
          <div
            style="
              flex: 1;
              text-align: center;
              padding: 20px 12px;
              color: #1b52a4;
              font-size: 20px;
            "
          >
            Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
          </div>
        </div>
      </div>
    </div>

    <script src="js/keyboard.js"></script>
    <script>
      function updateBloodSugarDisplay() {
        updateGlucoseText();
      }

      function showScreen(screenId) {
        document.querySelectorAll(".screen").forEach((screen) => {
          screen.classList.remove("active");
        });
        document.getElementById(screenId).classList.add("active");
        saveToLocalStorage();
      }

      function saveToLocalStorage() {
        const data = {
          currentValue: currentValue,
          carbInput: document.getElementById("carbInput")?.value || "",
          currentAmount: document.getElementById("currentAmount")?.value || "",
          extendedAmount:
            document.getElementById("extendedAmount")?.value || "",
          durationInput: document.getElementById("durationInput")?.value || "",
          currentAmount2:
            document.getElementById("currentAmount2")?.value || "",
          extendedAmount2:
            document.getElementById("extendedAmount2")?.value || "",
          durationInput2:
            document.getElementById("durationInput2")?.value || "",
        };
        localStorage.setItem("bolusData", JSON.stringify(data));
      }

      function loadFromLocalStorage() {
        const data = JSON.parse(localStorage.getItem("bolusData") || "{}");

        if (data.currentValue) {
          currentValue = data.currentValue;
          if (document.querySelector(".glucose-value")) {
            document.querySelector(
              ".glucose-value"
            ).innerHTML = `${currentValue}mg/dl`;
          }
          updateBloodSugarDisplay();
        }

        if (data.carbInput && document.getElementById("carbInput")) {
          document.getElementById("carbInput").value = data.carbInput;
        }

        if (data.currentAmount && document.getElementById("currentAmount")) {
          document.getElementById("currentAmount").value = data.currentAmount;
        }

        if (data.extendedAmount && document.getElementById("extendedAmount")) {
          document.getElementById("extendedAmount").value = data.extendedAmount;
        }

        if (data.durationInput && document.getElementById("durationInput")) {
          document.getElementById("durationInput").value = data.durationInput;
        }

        if (data.currentAmount2 && document.getElementById("currentAmount2")) {
          document.getElementById("currentAmount2").value = data.currentAmount2;
        }

        if (
          data.extendedAmount2 &&
          document.getElementById("extendedAmount2")
        ) {
          document.getElementById("extendedAmount2").value =
            data.extendedAmount2;
        }

        if (data.durationInput2 && document.getElementById("durationInput2")) {
          document.getElementById("durationInput2").value = data.durationInput2;
        }
      }

      // Add input event listeners for localStorage
      document.addEventListener("input", function (e) {
        if (e.target.classList.contains("virtual-keyboard-input")) {
          saveToLocalStorage();
        }
      });

      // Initialize
      document.addEventListener("DOMContentLoaded", function () {
        loadFromLocalStorage();
      });
    </script>
  </body>
  <script src="js/control-screen.js"></script>
</html>
